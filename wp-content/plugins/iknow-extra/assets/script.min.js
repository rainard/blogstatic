"use strict";document.addEventListener("DOMContentLoaded",()=>{const e=[...document.querySelectorAll(".vote")];e.length>0&&e.forEach(e=>{e.addEventListener("click",t=>{let n=e.getAttribute("data-vote"),o=e.getAttribute("data-post"),r=new XMLHttpRequest;r.open("POST",iknow_ajax.url,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.responseType="json",r.send("action=iknow_voting&nonce="+iknow_ajax.nonce+"&post_id="+o+"&vote="+n),r.onload=function(){if(200===r.status){let e=r.response;if("new"===e.status){let t=e.vote,n=document.querySelector("#"+t),o=n.textContent;o=parseInt(o)+1,n.textContent=o.toString();let r=parseInt(document.querySelector("#vote_yea").textContent),c=r+parseInt(document.querySelector("#vote_nay").textContent),a=Math.round(r/c*100);document.querySelector("#vote-progress").value=a,document.querySelector('[data-vote="'+t+'"]').setAttribute("disabled","disabled"),document.querySelector("#vote-response").innerHTML=e.message}else if("change"===e.status){let t=parseInt(document.querySelector("#"+e.change_up).textContent);t=parseInt(t)+1,document.querySelector("#"+e.change_up).textContent=t.toString(),document.querySelector('[data-vote="'+e.change_up+'"]').setAttribute("disabled","disabled");let n=parseInt(document.querySelector("#"+e.change_down).textContent);n=parseInt(n)-1,document.querySelector("#"+e.change_down).textContent=n.toString(),document.querySelector('[data-vote="'+e.change_down+'"]').removeAttribute("disabled"),document.querySelector("#vote-response").innerHTML=e.message;let o=parseInt(document.querySelector("#vote_yea").textContent),r=o+parseInt(document.querySelector("#vote_nay").textContent),c=Math.round(o/r*100);document.querySelector("#vote-progress").value=c}else"false"===e.status&&(document.querySelector("#vote-response").innerHTML=e.message)}}})});const t=[...document.querySelectorAll(".vote-comment")];t.length>0&&t.forEach(e=>{e.addEventListener("click",t=>{let n=e.getAttribute("data-vote-value"),o=e.getAttribute("data-vote-id"),r=new XMLHttpRequest;r.open("POST",iknow_ajax.url,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.responseType="json",r.send("action=iknow_comment_voting&nonce="+iknow_ajax.nonce+"&comment_id="+o+"&vote="+n),r.onload=function(){if(200===r.status){let e=r.response,t=e.comment_id;if("new"===e.status){let n=e.vote,o=document.querySelector("#comment_"+n+"_"+t),r=document.querySelector("#comment_"+n+"_"+t+" .comment-vote-count"),c=r.textContent;c=parseInt(c)+1,r.textContent=c.toString(),o.setAttribute("disabled","disabled")}else if("change"===e.status){let n=document.querySelector("#comment_"+e.change_up+"_"+t),o=document.querySelector("#comment_"+e.change_up+"_"+t+" .comment-vote-count"),r=parseInt(o.textContent);r=parseInt(r)+1,o.textContent=r.toString(),n.setAttribute("disabled","disabled");let c=document.querySelector("#comment_"+e.change_down+"_"+t),a=document.querySelector("#comment_"+e.change_down+"_"+t+" .comment-vote-count"),u=parseInt(a.textContent);u=parseInt(u)-1,a.textContent=u.toString(),c.removeAttribute("disabled")}}}})})});